CREATE TABLE IF NOT EXISTS LibraryRecord(
book_id INT, 
book_name VARCHAR(30),
shelf_no INT
);

INSERT INTO LibraryRecord (book_id, book_name, shelf_no)
VALUES
    (101, 'The Alchemist', 11),
    (102, 'To Kill a Mockingbird', 12),
    (103, '1984', 11),
    (104, 'The Great Gatsby', 13),
    (105, 'Pride and Prejudice', 12),
    (106, 'Brave New World', 13),
    (107, 'Moby-Dick', 14),
    (108, 'The Odyssey', 15),
    (109, 'War and Peace', 14),
    (110, 'The Hobbit', 16);

CREATE TABLE LibraryAudit(
book_id INT, 
book_name VARCHAR(30),
shelf_no INT
);

SET SQL_MODE = "ORACLE";

CREATE OR REPLACE TRIGGER update_backup
BEFORE UPDATE 
ON LibraryRecord 
FOR EACH ROW 
INSERT INTO LibraryAudit SET LibraryAudit.book_id = old.book_id, LibraryAudit.book_name = old.book_name, LibraryAudit.shelf_no = old.shelf_no;

UPDATE LibraryRecord SET book_id = 111 WHERE book_id = 110;

DROP TRIGGER update_backup;

SELECT * FROM LibraryRecord;

SELECT * FROM LibraryAudit;


CREATE OR REPLACE TRIGGER delete_backup 
AFTER DELETE 
ON LibraryRecord
FOR EACH ROW
INSERT INTO LibraryAudit SET book_id = old.book_id, book_name = old.book_name, shelf_no = old.shelf_no;

DELETE FROM LibraryRecord WHERE book_id = 109;

DROP TRIGGER delete_backup;

SELECT * FROM LibraryRecord;

SELECT * FROM LibraryAudit ;

DROP TABLE LibraryRecord;

DROP TABLE LibraryAudit;
	

